{
    "collab_server" : "",
    "contents" : "# script by Richie Hodel (richiehodel@gmail.com) #\n\n\nsetwd(\"/Users/richiehodel/Desktop/Amborella_ENM/cutoffs/\")\n\n####################################################################\n####################################################################\ninstall.packages('stringr')\nlibrary('stringr')\n\n#First need to get commands for vcftools to get allele frequencies\n#First do chromosomes 1-9\n\nfor (counter in 1:9){\n\nchr_num <- counter  \nfile_name <- paste(\"chr\",chr_num,\"_sites_01.txt\", sep=\"\")\nfile_name\nchr <- read.table(file=file_name, header=TRUE)\n\nfirst <- paste(\"vcftools --vcf out_all12_freebayes_chr\",chr_num,\n    \".recode.vcf --chr AT_V4_CHR0\",chr_num,\" --recode --out chr\", chr_num,\n    \"_loc\",sep=\"\")\nsecond <- \"_4000 --from-bp \"\nthird <- \" --to-bp \"\nfourth <- paste(\"vcftools --vcf chr\",chr_num,\"_loc\")\nfifth <- paste(\"_4000.recode.vcf --012 --out chr\",chr_num,\"_loc\")\nsixth <- \"_4000\"\nprinter <- NULL\nprinter2 <- NULL\nfor (j in 1:nrow(chr))\n{\n  printer <- paste(first,chr[j,1],second,chr[j,1]-2000,third,chr[j,1]+2000, \n                   sep=\"\")\n  printer <- paste(printer,fourth,sep=\"\\n\")\n  printer <- paste(printer,chr[j,1],fifth,chr[j,1],sixth, sep=\"\")\n  printer2[j] <- printer\n}\n\nvcf_name <- paste(\"vcf_commands_chr\",chr_num,\".txt\",sep=\"\")\nvcf_name\nwrite.table(printer2, file=vcf_name, quote=FALSE, \n            row.names = FALSE,col.names = FALSE)\n\n}\n####################################################################\n\n# Now chromosomes 10-13:\n\nfor (counter in 10:13){\n  \n  chr_num <- counter  \n  file_name <- paste(\"chr\",chr_num,\"_sites_01.txt\", sep=\"\")\n  file_name\n  chr <- read.table(file=file_name, header=TRUE)\n  \n  first <- paste(\"vcftools --vcf out_all12_freebayes_chr\",chr_num,\n                 \".recode.vcf --chr AT_V4_CHR\",chr_num,\" --recode --out chr\", chr_num,\n                 \"_loc\",sep=\"\")\n  second <- \"_4000 --from-bp \"\n  third <- \" --to-bp \"\n  fourth <- paste(\"vcftools --vcf chr\",chr_num,\"_loc\")\n  fifth <- paste(\"_4000.recode.vcf --012 --out chr\",chr_num,\"_loc\")\n  sixth <- \"_4000\"\n  printer <- NULL\n  printer2 <- NULL\n  for (j in 1:nrow(chr))\n  {\n    printer <- paste(first,chr[j,1],second,chr[j,1]-2000,third,chr[j,1]+2000, \n                     sep=\"\")\n    printer <- paste(printer,fourth,sep=\"\\n\")\n    printer <- paste(printer,chr[j,1],fifth,chr[j,1],sixth, sep=\"\")\n    printer2[j] <- printer\n  }\n  \n  vcf_name <- paste(\"vcf_commands_chr\",chr_num,\".txt\",sep=\"\")\n  vcf_name\n  write.table(printer2, file=vcf_name, quote=FALSE, \n              row.names = FALSE,col.names = FALSE)\n  \n}\n\n## Commands for vcftools are now complete.  Run the commands in vcftools\n## and move output files to a directory, one for each chromosome\n# (e.g., 'chr1' or 'chr8').\n\n\n##########   generating  ####################################################\n##########    freqs      ####################################################\n\n###################################################################\n###################################################################\nsetwd(\"/Users/richiehodel/Desktop/Amborella_ENM/\")\n\n#only once\ninds <- read.table(\"out.012.indv\")\n# get list of individual names (for use in naming rows, below)\nind_names <- as.vector(inds$V1)\ndf <- data.frame(ind_names)\n\n\n####################################################################\n####################################################################\n\n\nsetwd(\"/Users/richiehodel/Desktop/Amborella_ENM/chr1\")\nsizes1 <- file.size(list.files(\"/Users/richiehodel/Desktop/Amborella_ENM/chr1/\"))\nmin(sizes1)\nsetwd(\"/Users/richiehodel/Desktop/Amborella_ENM/cutoffs\")\nchr1 <- read.table(file=\"chr1_sites_01.txt\", header=TRUE)\nchr1_names <- as.character(chr1$SweeD_1.Position)\nchr1_names <- paste(\"chr1_loc\",chr1_names,sep=\"\")\ncolnames(chr1) <- c(\"Position\",\"Likelihood\")\n\nchr_all <- chr1\ncolnames(chr_all) <- c(\"Position\",\"Likelihood\")\n\nsetwd(\"/Users/richiehodel/Desktop/Amborella_ENM/chr2\")\nsizes2 <- file.size(list.files(\"/Users/richiehodel/Desktop/Amborella_ENM/chr2/\"))\nmin(sizes2)\n# no sites_01 for chr2\nsetwd(\"/Users/richiehodel/Desktop/Amborella_ENM/cutoffs\")\nchr2 <- read.table(file=\"chr2_sites_01.txt\", header=T)\nchr2_names <- as.character(chr2$SweeD_3.Position)\nchr2_names <- paste(\"chr2_loc\",chr2_names,sep=\"\")\ncolnames(chr2) <- c(\"Position\",\"Likelihood\")\n\nsetwd(\"/Users/richiehodel/Desktop/Amborella_ENM/chr3\")\nsizes3 <- file.size(list.files(\"/Users/richiehodel/Desktop/Amborella_ENM/chr3/\"))\nmin(sizes3)\nsetwd(\"/Users/richiehodel/Desktop/Amborella_ENM/cutoffs\")\nchr3 <- read.table(file=\"chr3_sites_01.txt\", header=T)\nchr3_names <- as.character(chr3$SweeD_3.Position)\nchr3_names <- paste(\"chr3_loc\",chr3_names,sep=\"\")\ncolnames(chr3) <- c(\"Position\",\"Likelihood\")\n\nsetwd(\"/Users/richiehodel/Desktop/Amborella_ENM/chr4\")\nsizes4 <- file.size(list.files(\"/Users/richiehodel/Desktop/Amborella_ENM/chr4/\"))\nmin(sizes4)\n# no sites_01 for chr4\nsetwd(\"/Users/richiehodel/Desktop/Amborella_ENM/cutoffs\")\nchr4 <- read.table(file=\"chr4_sites_01.txt\", header=T)\nchr4_names <- as.character(chr4$SweeD_4.Position)\nchr4_names <- paste(\"chr4_loc\",chr4_names,sep=\"\")\ncolnames(chr4) <- c(\"Position\",\"Likelihood\")\n\nsetwd(\"/Users/richiehodel/Desktop/Amborella_ENM/chr5\")\nsizes5 <- file.size(list.files(\"/Users/richiehodel/Desktop/Amborella_ENM/chr5/\"))\nmin(sizes5)\n# no sites_01 for chr5\nsetwd(\"/Users/richiehodel/Desktop/Amborella_ENM/cutoffs\")\nchr5 <- read.table(file=\"chr5_sites_01.txt\", header=T)\nchr5_names <- as.character(chr5$SweeD_5.Position)\nchr5_names <- paste(\"chr5_loc\",chr5_names,sep=\"\")\ncolnames(chr5) <- c(\"Position\",\"Likelihood\")\n\nsetwd(\"/Users/richiehodel/Desktop/Amborella_ENM/chr6\")\nsizes6 <- file.size(list.files(\"/Users/richiehodel/Desktop/Amborella_ENM/chr6/\"))\nmin(sizes6)\nsetwd(\"/Users/richiehodel/Desktop/Amborella_ENM/cutoffs\")\nchr6 <- read.table(file=\"chr6_sites_01.txt\", header=T)\nchr6_names <- as.character(chr6$SweeD_6.Position)\nchr6_names <- paste(\"chr6_loc\",chr6_names,sep=\"\")\ncolnames(chr6) <- c(\"Position\",\"Likelihood\")\n\nsetwd(\"/Users/richiehodel/Desktop/Amborella_ENM/chr7\")\nsizes7 <- file.size(list.files(\"/Users/richiehodel/Desktop/Amborella_ENM/chr7/\"))\nmin(sizes7)\nsetwd(\"/Users/richiehodel/Desktop/Amborella_ENM/cutoffs\")\nchr7 <- read.table(file=\"chr7_sites_01.txt\", header=T)\nchr7_names <- as.character(chr7$SweeD_7.Position)\nchr7_names <- paste(\"chr7_loc\",chr7_names,sep=\"\")\ncolnames(chr7) <- c(\"Position\",\"Likelihood\")\n\nsetwd(\"/Users/richiehodel/Desktop/Amborella_ENM/chr8\")\nsizes8 <- file.size(list.files(\"/Users/richiehodel/Desktop/Amborella_ENM/chr8/\"))\nsizes8\nmin(sizes8) \n# some files have no data\nsetwd(\"/Users/richiehodel/Desktop/Amborella_ENM/cutoffs\")\nchr8 <- read.table(file=\"chr8_sites_01.txt\", header=T)\nchr8_names <- as.character(chr8$SweeD_8.Position)\nchr8_names <- paste(\"chr8_loc\",chr8_names,sep=\"\")\ncolnames(chr8) <- c(\"Position\",\"Likelihood\")\n\n# need to remove these loci with no data from dataset\n\n\nfiles8 <- list.files(\"/Users/richiehodel/Desktop/Amborella_ENM/chr8/\")\nnozeros8 <- data.frame(files8,sizes8)\nnozeros8 <- subset(nozeros8, nozeros8$sizes8!=0)\nvar1 <- str_split_fixed(nozeros8$files8, \"loc\", 2)\nvar1 <- data.frame(var1)\nvar2 <- str_split_fixed(var1$X2, \"_\",2)\nvar2 <- data.frame(var2)\nvar3 <- str_split_fixed(nozeros8$files8, \".012.\",2)\nvar3 <- data.frame(var3)\n\nvar8 <- data.frame(var1,var2,var3)\nvar8 <- subset(var8, var8$X2.2==\"pos\")\n\n# now need to find intersection--done\n# clean up var names\n\ndata_present <- var8$X1.1\nchr8 <- chr8[chr8$Position %in% data_present, ]\nchr8_names <- as.character(chr8$Position)\nchr8_names <- paste(\"chr8_loc\",chr8_names,sep=\"\")\n\nsetwd(\"/Users/richiehodel/Desktop/Amborella_ENM/chr9\")\nsizes9 <- file.size(list.files(\"/Users/richiehodel/Desktop/Amborella_ENM/chr9/\"))\nmin(sizes9)\nsetwd(\"/Users/richiehodel/Desktop/Amborella_ENM/cutoffs\")\nchr9 <- read.table(file=\"chr9_sites_01.txt\", header=T)\nchr9_names <- as.character(chr9$SweeD_9.Position)\nchr9_names <- paste(\"chr9_loc\",chr9_names,sep=\"\")\ncolnames(chr9) <- c(\"Position\",\"Likelihood\")\n\nsetwd(\"/Users/richiehodel/Desktop/Amborella_ENM/chr10\")\nsizes10 <- file.size(list.files(\"/Users/richiehodel/Desktop/Amborella_ENM/chr10/\"))\nmin(sizes10)\nsetwd(\"/Users/richiehodel/Desktop/Amborella_ENM/cutoffs\")\nchr10 <- read.table(file=\"chr10_sites_01.txt\", header=T)\nchr10_names <- as.character(chr10$SweeD_10.Position)\nchr10_names <- paste(\"chr10_loc\",chr10_names,sep=\"\")\ncolnames(chr10) <- c(\"Position\",\"Likelihood\")\n\nsetwd(\"/Users/richiehodel/Desktop/Amborella_ENM/chr11\")\nsizes11 <- file.size(list.files(\"/Users/richiehodel/Desktop/Amborella_ENM/chr11/\"))\nmin(sizes11)\nsetwd(\"/Users/richiehodel/Desktop/Amborella_ENM/cutoffs\")\nchr11 <- read.table(file=\"chr11_sites_01.txt\", header=T)\nchr11_names <- as.character(chr11$SweeD_11.Position)\nchr11_names <- paste(\"chr11_loc\",chr11_names,sep=\"\")\ncolnames(chr11) <- c(\"Position\",\"Likelihood\")\n\nsetwd(\"/Users/richiehodel/Desktop/Amborella_ENM/chr12\")\nsizes12 <- file.size(list.files(\"/Users/richiehodel/Desktop/Amborella_ENM/chr12/\"))\nmin(sizes12)\nsetwd(\"/Users/richiehodel/Desktop/Amborella_ENM/cutoffs\")\nchr12 <- read.table(file=\"chr12_sites_01.txt\", header=T)\nchr12_names <- as.character(chr12$SweeD_12.Position)\nchr12_names <- paste(\"chr12_loc\",chr12_names,sep=\"\")\ncolnames(chr12) <- c(\"Position\",\"Likelihood\")\n\nsetwd(\"/Users/richiehodel/Desktop/Amborella_ENM/chr13\")\nsizes13 <- file.size(list.files(\"/Users/richiehodel/Desktop/Amborella_ENM/chr13/\"))\nmin(sizes13)\nsetwd(\"/Users/richiehodel/Desktop/Amborella_ENM/cutoffs\")\nchr13 <- read.table(file=\"chr13_sites_01.txt\", header=T)\nchr13_names <- as.character(chr13$SweeD_13.Position)\nchr13_names <- paste(\"chr13_loc\",chr13_names,sep=\"\")\ncolnames(chr13) <- c(\"Position\",\"Likelihood\")\n\nchr_all <- rbind(chr_all, chr2, chr3, chr4, chr5, chr6, chr7,\n                 chr8, chr9, chr10, chr11, chr12, chr13)\n\nsetwd(\"/Users/richiehodel/Desktop/Amborella_ENM/chr1/\")\nfreqs <- NULL\nm <- nrow(chr1)\nfor (k in 1:m){\n  dummy <- freq_calc(locus=chr1$Position[k],\"chr1\")\n  df <- cbind(df,dummy)\n  rm(dummy)\n}\nsetwd(\"/Users/richiehodel/Desktop/Amborella_ENM/chr3/\")\nm <- nrow(chr3)\nfor (k in 1:m){\n  dummy <- freq_calc(locus=chr3$Position[k],\"chr3\")\n  df <- cbind(df,dummy)\n  rm(dummy)\n}\nsetwd(\"/Users/richiehodel/Desktop/Amborella_ENM/chr6/\")\nm <- nrow(chr6)\nfor (k in 1:m){\n  dummy <- freq_calc(locus=chr6$Position[k],\"chr6\")\n  df <- cbind(df,dummy)\n  rm(dummy)\n}\nsetwd(\"/Users/richiehodel/Desktop/Amborella_ENM/chr7/\")\nm <- nrow(chr7)\nfor (k in 1:m){\n  dummy <- freq_calc(locus=chr7$Position[k],\"chr7\")\n  df <- cbind(df,dummy)\n  rm(dummy)\n}\n\nsetwd(\"/Users/richiehodel/Desktop/Amborella_ENM/chr8/\")\nm <- nrow(chr8)\nfor (k in 1:m){\n  dummy <- freq_calc(locus=chr8$Position[k],\"chr8\")\n  df <- cbind(df,dummy)\n  rm(dummy)\n}\n\nsetwd(\"/Users/richiehodel/Desktop/Amborella_ENM/chr9/\")\nm <- nrow(chr9)\nfor (k in 1:m){\n  dummy <- freq_calc(locus=chr9$Position[k],\"chr9\")\n  df <- cbind(df,dummy)\n  rm(dummy)\n}\nsetwd(\"/Users/richiehodel/Desktop/Amborella_ENM/chr10/\")\nm <- nrow(chr10)\nfor (k in 1:m){\n  dummy <- freq_calc(locus=chr10$Position[k],\"chr10\")\n  df <- cbind(df,dummy)\n  rm(dummy)\n}\nsetwd(\"/Users/richiehodel/Desktop/Amborella_ENM/chr11/\")\nm <- nrow(chr11)\nfor (k in 1:m){\n  dummy <- freq_calc(locus=chr11$Position[k],\"chr11\")\n  df <- cbind(df,dummy)\n  rm(dummy)\n}\nsetwd(\"/Users/richiehodel/Desktop/Amborella_ENM/chr13/\")\nm <- nrow(chr13)\nfor (k in 1:m){\n  dummy <- freq_calc(locus=chr13$Position[k],\"chr13\")\n  df <- cbind(df,dummy)\n  rm(dummy)\n}\n  \n  \n  \ncolnames(df) <- c(\"ind_names\",chr1_names, chr3_names, chr6_names,\n                  chr7_names, chr8_names, chr9_names, chr10_names,\n                  chr11_names, chr13_names)\n\nsetwd(\"/Users/richiehodel/Desktop/Amborella_ENM/\")\nwrite.table(df, file=\"freq_list.txt\", quote=FALSE, row.names=FALSE)\n\n\n\n\n###################################################################\n###################################################################\n#######################\n#####  function   #####\n\nfreq_calc <- function(locus=\"\", chromo_num=\"\") {\n  loci <- read.table(paste(chromo_num,\"_loc\",locus,\"_4000.012.pos\", sep=\"\"))\n  inds <- read.table(paste(chromo_num,\"_loc\",locus,\"_4000.012.indv\", sep=\"\"))\n  loci_names <- as.vector(loci$V2)\n  alleles <- read.table(paste(chromo_num,\"_loc\",locus,\"_4000.012\", sep=\"\"), row.names=ind_names)\n  alleles$V1 <- NULL\n  colnames(alleles) <- loci_names\n  alleles[alleles == -1] <- 0\n  i=1\n  for (i in 1:length(inds$V1)) {\n    freqs[i] <- sum(alleles[i,])/(2*length(alleles))\n    freqs[i] <- 1-freqs[i]\n  }\n  return(freqs)\n  \n}\n\n#####  end function   #####\n###########################\n\n",
    "created" : 1518022532364.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1139075331",
    "id" : "3AA56F7D",
    "lastKnownWriteTime" : 1518026517,
    "last_content_update" : 1518026517575,
    "path" : "~/Desktop/Amborella_ENM/Allele_Freq.R",
    "project_path" : "Allele_Freq.R",
    "properties" : {
    },
    "relative_order" : 4,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}